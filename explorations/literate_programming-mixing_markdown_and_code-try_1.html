<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
</head>
<body>
<h1 id="literate-programming-mixing-markdown-documents-with-programming-code-try-1">Literate programming â€” Mixing markdown documents with programming code; Try 1</h1>
<p>Looking at writing programming code in markdown, there are multiple ways to do so. The most obvious way to add code to markdown is to enclose all code blocks in between lines starting with, at least, three tildes.</p>
<pre><code># say, like this.</code></pre>
<p>To run a literate program, then, is to find a way to get the code out the document and feed it to the compiler or interpreter. A simple way to go about that, could be to inspect each line in the document. If the line is part of a code block, keep it, if not, discard it.</p>
<p>Let us interpret a document as a sequence of lines. We use a simple state machine with two states, <em>in code block</em> and <em>out code block</em>, starting in out of code block. If we encounter a code block delimiter as defined above, i.e., a line starting with three tildes, we change state to in code block. In that state, every next line will be collected into the runnable program. Whenever we encounter the code block delimiter we will discard that line. Furthermore, all lines outside a code block will be discarded as well.</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="dt">CODE_BLOCK_DELIMITER</span> = <span class="ot">/^~~~.*$/</span>

<span class="kw">def</span> program_collector(document)
    program = []
    incode = <span class="dv">false</span>
    while <span class="kw">not</span> document.empty? <span class="kw">do</span>
        line = document.shift
        <span class="kw">if</span> line =~ <span class="dt">CODE_BLOCK_DELIMITER</span> <span class="kw">then</span>
            incode = ! incode
            <span class="kw">next</span>
        <span class="kw">end</span>

        program.push line <span class="kw">if</span> incode
    <span class="kw">end</span>

    program.join
<span class="kw">end</span></code></pre>
<p>Now, to test this simple program, we run it on this file.</p>
<pre><code>document = File.readlines ARGV[0]
program = program_collector document
puts program</code></pre>
<p>Of course, this being the first document, the program to create a runnable program from it does not yet exists. To that end, we bootstrap this script. We copy all the code into a new file, and then run that on this document.</p>
</body>
</html>
